<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!--This file was converted to xhtml by OpenOffice.org - see http://xml.openoffice.org/odf2xhtml for more info.--><head profile="http://dublincore.org/documents/dcmi-terms/"><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/><title xml:lang="en-US">Копировщик домофонных ключей  RECTO-Copier</title><meta name="DCTERMS.title" content="Копировщик домофонных ключей  RECTO-Copier" xml:lang="en-US"/><meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646"/><meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml"/><meta name="DCTERMS.creator" content="RECTO"/><meta name="DCTERMS.issued" content="2012-10-24T01:00:00" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.contributor" content="Horner"/><meta name="DCTERMS.modified" content="2016-02-11T03:52:00" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.provenance" content="" xml:lang="en-US"/><meta name="DCTERMS.subject" content="," xml:lang="en-US"/><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en"/><link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en"/><link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en"/><style type="text/css">
	@page {  }
	table { border-collapse:collapse; border-spacing:0; empty-cells:show }
	td, th { vertical-align:top; font-size:12pt;}
	h1, h2, h3, h4, h5, h6 { clear:both }
	ol, ul { margin:0; padding:0;}
	li { list-style: none; margin:0; padding:0;}
	<!-- "li span.odfLiEnd" - IE 7 issue-->
	li span. { clear: both; line-height:0; width:0; height:0; margin:0; padding:0; }
	span.footnodeNumber { padding-right:1em; }
	span.annotation_style_by_filter { font-size:95%; font-family:Arial; background-color:#fff000;  margin:0; border:0; padding:0;  }
	* { margin:0;}
	.P1 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; margin-top:0.212cm; margin-bottom:0cm; text-align:center ! important; }
	.P2 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; margin-left:0cm; margin-right:0cm; text-align:justify ! important; text-indent:1cm; }
	.P3 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; margin-left:0cm; margin-right:0cm; text-align:justify ! important; text-indent:1cm; color:#0000ff; font-weight:bold; }
	.P4 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; margin-left:0cm; margin-right:0cm; margin-top:0.212cm; margin-bottom:0cm; text-indent:1cm; }
	.P5 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; margin-left:0cm; margin-right:0cm; margin-top:0.212cm; margin-bottom:0cm; text-align:justify ! important; text-indent:1cm; }
	.P6 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; margin-left:0cm; margin-right:0cm; text-align:justify ! important; text-indent:1cm; color:#0000ff; font-weight:bold; }
	.P7 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; text-align:center ! important; }
	.P8 { font-size:12pt; margin-left:0cm; margin-right:0cm; text-align:justify ! important; text-indent:1cm; font-family:Times New Roman; writing-mode:lr-tb; color:#0000ff; font-weight:bold; }
	.P9 { font-size:12pt; margin-left:0cm; margin-right:0cm; text-align:justify ! important; text-indent:1cm; font-family:Times New Roman; writing-mode:lr-tb; margin-top:0.212cm; margin-bottom:0cm; }
	.Text_20_body_20_indent { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; margin-left:0cm; margin-right:0cm; text-align:justify ! important; text-indent:1cm; }
	.T1 { font-weight:bold; }
	.T10 { color:#ff0000; text-decoration:underline; font-weight:bold; }
	.T11 { color:#ffff00; text-decoration:underline; font-weight:bold; }
	.T12 { color:#ffff00; font-weight:bold; }
	.T13 { color:#008000; }
	.T14 { color:#008000; text-decoration:underline; font-weight:bold; }
	.T15 { color:#008000; font-weight:bold; }
	.T17 { color:#0000ff; font-weight:bold; }
	.T18 { color:#0000ff; }
	.T19 { color:#0000ff; font-weight:bold; }
	.T2 { font-size:16pt; font-weight:bold; }
	.T3 { font-size:16pt; font-style:italic; font-weight:bold; }
	.T5 { font-weight:bold; }
	.T6 { font-size:14pt; font-weight:bold; }
	.T7 { font-size:14pt; font-weight:bold; }
	.T9 { text-decoration:underline; }
	<!-- ODF styles with no properties representable as CSS -->
	.T4 { }
	</style></head><body dir="ltr" style="max-width:21.001cm;margin-top:1.7cm; margin-bottom:1.7cm; margin-left:3cm; margin-right:1.501cm; "><p class="P7"><span class="T2">Копировщик домофонных ключей  </span><span class="T3">RECTO-Copier</span></p><p class="P1"><span class="T6">Описание минимальной конфигурации, версия 5.</span><span class="T7">26</span></p><p class="P2"> </p><p class="P2"> </p><p class="P2">Данное устройство можно собрать в минимальной конфигурации, когда его полный функционал не нужен, а требуется лишь читать и записывать ключи<span class="T4"> </span>типа <span class="T4">Touch Memory</span>. При этом для управления устройством будет достаточно лишь одной кнопки <span class="T5">S1</span>, а для индикации - трех светодиодов. Дополнительные функции могут поддерживаться, но на схеме и на печатной плате они аппаратно отключены.</p><p class="P2"> </p><p class="P2"> </p><p class="P8">Описание конструкции.</p><p class="P2"> </p><p class="Text_20_body_20_indent"><span class="T1">Светодиоды</span> можно использовать любых цветов, предлагаемая схема носит лишь рекомендательный характер. Но для удобства изложения, описание сигналов будет приведено в соответствии с этой схемой.</p><p class="P9"><span class="T10">Красный</span> (<span class="T5">HL</span><span class="T1">1</span>) – индикатор питания<span class="T4"> </span>«<span class="T5">POWER</span>», а так же индикатор разряда батареи. Если в устройстве реализован детектор снижения напряжения питания, то при его срабатывании индикатор начинает светиться прерывистым светом – для этого сам светодиод должен быть подключен так же, как на схеме полной конфигурации.</p><p class="P9"><span class="T11">Желтый</span> (<span class="T5">HL</span><span class="T1">2</span>) – обозначен как «<span class="T5">READ</span>», выдает сигнал о чтении ключа. Загорается и горит постоянно, если в памяти устройства находится ключ. Если индикатор не горит – значит, ключа в памяти нет.</p><p class="P9"><span class="T14">Зеленый</span> (<span class="T5">HL</span><span class="T1">3</span>) – обозначен как «<span class="T5">WRITE</span>», в режиме записи сигнализирует об окончании процесса. При этом, если индикатор горит обычным светом – запись проведена успешно, а если мерцающим – ошибка. Кроме того, в режиме чтения короткими вспышками отмечает чтение ключа.</p><p class="P2"> </p><p class="P2">В минимальной конфигурации также можно использовать еще один сигнализатор – акустический излучатель, его подключение смотрите по схеме полной конфигурации. Понадобится электромагнитный излучатель, без встроенного генератора.</p><p class="P9">На прилагаемой к проекту печатной плате под минимальную конфигурацию уже установлены все перемычки для отключения функций контроля и управления питанием.  А так же подписаны контакты под ЖК-дисплей – он будет работать, если его подключить.</p><p class="P2"> </p><p class="P2"> </p><p class="P3">Работа с устройством.</p><p class="P2"> </p><p class="P2">Сразу же после включения питания на 2 секунды зажигаются все светодиоды – режим тестирования. Далее <span class="T12">желтый</span> и <span class="T15">зеленый</span> светодиоды погаснут – устройство перешло в режим ожидания для чтения ключа. </p><p class="P5">Если при тестировании в базе <span class="T4">EEPROM</span> обнаруживается ключ, он будет сразу же загружен оттуда в память устройства. При этом будет светиться <span class="T12">желтый</span> светодиод – признак того, что в памяти устройства есть ключ. Если в памяти <span class="T4">EEPROM</span> записано несколько ключей, то будет загружен первый найденный ключ.</p><p class="P5">Для чтения ключа прикладываем его к контактам считывателя. При удачном чтении ключа загорается <span class="T12">желтый </span>светодиод. Если чтение произошло с ошибкой (некорректная <span class="T4">CRC</span> для ключей «<span class="T4">Dallas</span>», либо неверный формат данных для ключей «<span class="T4">Cyfral</span>»<span class="T4"> </span>или «Метаком»), <span class="T12">желтый</span> светодиод не горит (гаснет). Момент чтения ключа отмечается кратковременной вспышкой <span class="T15">зеленого</span> светодиода и коротким одиночным звуковым сигналом. При этом количество вспышек указывает на формат прочитанного ключа: «<span class="T4">Dallas</span>» – одиночная вспышка, «Метаком» – двойная, «<span class="T4">Cyfral</span>» – тройная. Это позволит определить формат прочитанного ключа в минимальной конфигурации устройства без ЖК-дисплея. Если ключ не убрать со считывателя, то копировщик будет циклически повторять чтение ключа с интервалом примерно 1 сек. – это можно наблюдать по вспышкам <span class="T15">зеленого</span> светодиода и звуковому сигналу.</p><p class="P5">Скопируем теперь прочитанный код на перезаписываемую заготовку. Для перевода устройства в режим записи нажимите кнопку <span class="T5">S1</span>. При этом одновременно загорятся <span class="T12">желтый</span> и <span class="T15">зеленый</span><span class="T13"> </span>светодиоды. Повторное нажатие <span class="T5">S1</span><span class="T4"> </span>переведет устройство обратно в режим чтения, при этом загорится один <span class="T12">желтый</span> светодиод.</p><p class="P5">Прикладываем заготовку. Копировщик автоматически определит тип заготовки и сразу начнет запись. При этом <span class="T12">желтый</span> и <span class="T15">зеленый</span> светодиоды погаснут. Удерживайте заготовку на контактах считывателя. По окончании записи загорится один <span class="T15">зеленый</span> светодиод и прозвучит сдвоенный звуковой сигнал. Если <span class="T15">зеленый</span> светодиод горит постоянным светом – запись произведена успешно. А если мерцающим светом – ошибка. Если после прикладывания заготовки светодиоды сразу же начали перемигиваться – это значит, что запись на эту заготовку произвести нельзя, приложите другую заготовку.</p><p class="P5">Через пару секунд <span class="T15">зеленый</span> светодиод погаснет и загорится <span class="T12">желтый</span> светодиод – устройство автоматически перешло в режим чтения, а в его памяти находится ранее прочитанный ключ. Теперь можно сделать еще одну копию этого же ключа – нажать кнопку <span class="T5">S1</span><span class="T4"> </span>и приложить заготовку, а можно прочитать другой ключ – для этого просто приложите его к считывателю.</p><p class="P2"> </p><p class="P2"> </p><p class="P2"><span class="T17">Копирование ключей Метаком и </span><span class="T19">Cyfral</span><span class="T17">.</span></p><p class="P2"> </p><p class="P2">Данный копировщик позволяет производить запись ключей «Метаком» и «<span class="T4">Cyfral</span>»<span class="T4"> </span>в их оригинальном формате на универсальную заготовку <span class="T1">ТМ-01.</span> Выбор формата записи производится автоматически по типу ключа, загруженного в память. Т. е., ключ «<span class="T4">Dallas</span>» будет записан в формате <span class="T4">Dallas</span>, ключ «Метаком» – как Метаком, «<span class="T4">Cyfral</span>»<span class="T4"> – </span>как <span class="T4">Cyfral</span>.</p><p class="P5">При записи в форматах Метаком и <span class="T4">Cyfral</span> заготовка <span class="T1">ТМ-01</span> финализируется, после чего ее перезапись будет невозможна. Снятие финализации и последующая перезапись кода возможна только для заготовок <span class="T1">ТМ-01С</span>,<span class="T1"> ТМ-01С+ </span>и<span class="T1"> ТМ-01А</span>. Снятие финализации производится автоматически при записи заготовки, никаких дополнительных действий для этого делать не нужно. Следует учитывать, что данные заготовки, записанные в режимах «Метаком» или «<span class="T4">Cyfral</span>», распознаются копировщиком в «ознакомительном» режиме (см. ниже) как ключи «Метаком» или «<span class="T4">Cyfral</span>», не подлежащие перезаписи. Тем не менее, запись на них производится.</p><p class="P5">При использовании других заготовок: <span class="T1">ТМ-2004</span><span class="T4">, </span><span class="T1">ТМ-08, </span><span class="T5">RW-1990</span><span class="T1">.1</span><span class="T4"> </span>и <span class="T5">RW-1990.2</span> ключи «Метаком» и «<span class="T4">Cyfral</span>» будут записаны в формате «Даллас», вариант перекодировки  Вы должны выбрать самостоятельно в зависимости от модели домофона, для которого копируется ключ. Так, ключ «Метаком» может быть записан в двух вариантах перекодировки: <span class="T1">М1</span> – в прямом виде, и <span class="T1">М2</span> – с переворотом кода. Для ключей «<span class="T4">Cyfral</span>» также поддерживаются перекодировки: <span class="T1">С1</span> (прямой код), <span class="T1">С2</span> и <span class="T1">С3</span>.</p><p class="P5">Чтобы записать прямой код (<span class="T1">М1</span> или <span class="T1">С1</span>), просто переведите устройство в режим записи одиночным нажатием <span class="T5">S1</span><span class="T4"> </span>и запишите заготовку. Если требуется сделать запись с перекодировкой, включите нужную кодировку двойным нажатием <span class="T5">S1</span><span class="T4"> </span>из режима чтения. Кодировки будут переключаться по кругу: для ключей «Метаком»: <span class="T1">М1</span>–<span class="T1">М2</span>–<span class="T1">М1</span>–<span class="T1">М2</span> и т.д,  для ключей «<span class="T4">Cyfral</span>»: <span class="T1">С1</span>–<span class="T1">С2</span>–<span class="T1">С3</span>–<span class="T1">С1</span>–<span class="T1">С2</span>–<span class="T1">С3</span> и т.д. Признаком включенной перекодировки является мигание <span class="T12">желтого</span> светодиода. Если светодиод горит постоянным светом, то значит – в буфере находится прямой, исходный код ключа.</p><p class="P6">Запись произвольного кода.</p><p class="P2"> </p><p class="P2">Иногда бывает нужно записать ключ, код которого известен, но оригинала этого ключа в наличии нету, то есть считать его неоткуда. Это может быть, например, ключ-«вездеход», или просто какой-нибудь ключ из базы…</p><p class="P5">Для того, чтобы записать такой произвольный код, откройте в программаторе файл прошивки и отредактируйте область данных <span class="T4">EEPROM</span>. Код ключа необходимо записать в область <span class="T4">EEPROM</span>-данных по адресам <span class="T1">00-07</span>, первым байтом записывается код семейства, последним – контрольная сумма <span class="T4">CRC</span>. Ключи формата «<span class="T4">Dallas</span>» записываются 1 в 1. Ключи «Метаком» и «<span class="T4">Cyfral</span>» записываются в формате «<span class="T4">Dallas</span>» в кодировках <span class="T1">М1</span> и <span class="T1">С1</span> соответственно.<span class="T4"> </span>Однако при этом нужно указать копировщику на требуемый формат ключа, для этого байт «<span class="T4">Family code</span>» <span class="T1">01</span><span class="T4">h</span> необходимо заменить на <span class="T1">81</span><span class="T4">h</span>. При этом <span class="T4">CRC </span>пересчитывать <span class="T1">не нужно</span>!</p><p class="P5">Например, для записи<span class="T4"> </span>популярного ключа-«вездехода» <span class="T4">9B0000FFFFFFFF01 </span>внесите в <span class="T4">EEPROM</span> с нулевого адреса данные: <span class="T1">01</span><span class="T5">, FF, FF, FF, FF, 00, 00, 9B</span>. Этот ключ будет записан устройством в формате «<span class="T4">Dallas</span>» на любую поддерживаемую заготовку.</p><p class="P5">Для записи этого же ключа, но в формате «Метаком», введите в <span class="T4">EEPROM</span> данные следующим образом: <span class="T1">81</span><span class="T5">, FF, FF, FF, FF, 00, 00, 9B</span><span class="T1">. </span>При использовании заготовки <span class="T1">ТМ-01</span> этот ключ будет записан в оригинальном формате «Метаком».</p><p class="P2"> </p><p class="P2"> </p><p class="P3">Дополнительные возможности.</p><p class="P2"> </p><p class="P2"><span class="T5">1</span><span class="T1">. Ознакомительный режим.</span> Он включается, если нажать и удерживать кнопку <span class="T5">S1</span>. Этот режим позволяет протестировать заготовку, не производя записи на нее. При отпускании кнопки <span class="T5">S1</span><span class="T4"> </span>устройство перейдёт в режим записи, если в буфере имеется ранее прочитанный ключ. Либо перейдёт в режим чтения, если ключа в буфере нет.</p><p class="P5">Приложите заготовку к считывателю, <span class="T9">удерживая</span> кнопку <span class="T5">S1</span> – <span class="T12">желтый</span> и <span class="T15">зеленый</span> светодиоды начнут мигать. При этом, если они мигают вместе, значит на эту заготовку можно произвести запись. А если они мигают попеременно – запись произвести нельзя. Можно протестировать сразу несколько заготовок подряд, удерживая кнопку <span class="T5">S1</span><span class="T1"> </span>и поочередно прикладывая их к контактам. Когда заготовка не приложена к считывателю, <span class="T12">желтый</span> и <span class="T15">зеленый</span> светодиоды будут гореть постоянно.</p><p class="P5"><span class="T1">2. Чтение и запись ключей с некорректной </span><span class="T5">CRC</span><span class="T1">.</span> Ходят слухи, что попадаются иногда такие ключи… В копировщике данной версии имеется возможность отключить контроль <span class="T4">CRC</span> для работы с такими ключами. Для этого нужно будет внести изменения в прошивку. В прошивке <span class="T1">5.2</span><span class="T5">6</span> для <span class="T4">PIC16F628A</span> по адресу <span class="T1">06</span><span class="T5">7C</span> замените слово <span class="T5">18F8</span> на <span class="T1">0000</span><span class="T5"> </span>и так же по адресу <span class="T1">06</span><span class="T5">B5</span><span class="T4"> </span>слово <span class="T5">18F8</span> замените на <span class="T1">0000</span>. В прошивках для <span class="T4">PIC16F648A </span>и <span class="T4">PIC16F88</span> по адресу <span class="T1">0000</span> замените слово <span class="T1">3001</span> на <span class="T1">3000</span>.</p><p class="P5">После такой замены устройство можно будет перевести в режим записи после чтения «битого» ключа. Что в тот момент находилось в приемном буфере, то и запишется на заготовку. В версии для <span class="T4">PIC16F628A</span> чтение «битого» ключа не подтверждается звуковым сигналом и светодиодами, будьте внимательны!</p><p class="P9">Для записи произвольного ключа с некорректной <span class="T4">CRC </span>запишите его в <span class="T4">EEPROM</span> по адресам <span class="T1">00-07</span>, остальные ячейки оставьте пустыми (=<span class="T5">FF</span><span class="T4">h)</span>. В версии для <span class="T4">PIC16F628A</span> наличие такого ключа в буфере не будет отображаться индикацией <span class="T12">желтого </span> светодиода.</p><p class="P9">На этом пока всё. Как и всегда, жду Ваших отзывов в этой ветке, или в личку.</p><p class="Text_20_body_20_indent"> </p><p class="P4"><span class="T19">RECTO</span><span class="T18">.</span></p></body></html>