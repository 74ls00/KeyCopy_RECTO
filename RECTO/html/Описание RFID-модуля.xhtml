<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!--This file was converted to xhtml by OpenOffice.org - see http://xml.openoffice.org/odf2xhtml for more info.--><head profile="http://dublincore.org/documents/dcmi-terms/"><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/><title xml:lang="en-US">RFID-модуль</title><meta name="DCTERMS.title" content="RFID-модуль" xml:lang="en-US"/><meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646"/><meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml"/><meta name="DCTERMS.creator" content="RECTO"/><meta name="DCTERMS.issued" content="2013-09-27T00:44:00" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.contributor" content="Horner"/><meta name="DCTERMS.modified" content="2016-02-11T04:00:00" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.provenance" content="" xml:lang="en-US"/><meta name="DCTERMS.subject" content="," xml:lang="en-US"/><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en"/><link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en"/><link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en"/><style type="text/css">
	@page {  }
	table { border-collapse:collapse; border-spacing:0; empty-cells:show }
	td, th { vertical-align:top; font-size:12pt;}
	h1, h2, h3, h4, h5, h6 { clear:both }
	ol, ul { margin:0; padding:0;}
	li { list-style: none; margin:0; padding:0;}
	<!-- "li span.odfLiEnd" - IE 7 issue-->
	li span. { clear: both; line-height:0; width:0; height:0; margin:0; padding:0; }
	span.footnodeNumber { padding-right:1em; }
	span.annotation_style_by_filter { font-size:95%; font-family:Arial; background-color:#fff000;  margin:0; border:0; padding:0;  }
	* { margin:0;}
	.Heading_20_1 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; margin-left:0cm; margin-right:0cm; margin-top:0.212cm; margin-bottom:0cm; text-align:justify ! important; text-indent:1cm; font-weight:bold; }
	.P1 { font-size:16pt; font-family:Times New Roman; writing-mode:lr-tb; margin-left:0cm; margin-right:0cm; text-align:center ! important; text-indent:1cm; font-style:italic; }
	.P2 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; margin-left:0cm; margin-right:0cm; margin-top:0.212cm; margin-bottom:0cm; text-indent:1cm; }
	.P3 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; margin-left:0cm; margin-right:0cm; margin-top:0.212cm; margin-bottom:0cm; text-align:justify ! important; text-indent:1cm; }
	.P4 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; margin-left:0cm; margin-right:0cm; margin-top:0.212cm; margin-bottom:0cm; text-align:justify ! important; text-indent:1cm; }
	.P5 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; margin-left:0cm; margin-right:0cm; text-align:center ! important; text-indent:1cm; }
	.Text_20_body_20_indent { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; margin-left:0cm; margin-right:0cm; margin-top:0.212cm; margin-bottom:0cm; text-align:justify ! important; text-indent:1cm; }
	.T1 { font-weight:bold; }
	.T2 { font-size:16pt; font-style:italic; font-weight:bold; }
	.T3 { font-size:16pt; font-style:italic; font-weight:bold; }
	.T5 { font-weight:bold; }
	.T6 { color:#000000; font-weight:bold; }
	.T7 { color:#ff0000; font-weight:bold; }
	<!-- ODF styles with no properties representable as CSS -->
	.T4 { }
	</style></head><body dir="ltr" style="max-width:21.001cm;margin-top:2cm; margin-bottom:2cm; margin-left:2.501cm; margin-right:1.501cm; "><p class="P5"><span class="T3">RFID-</span><span class="T2">модуль</span></p><p class="P1">для копировщика домофонных ключей</p><p class="P2"> </p><p class="P3"><span class="T4">RFID-</span>модуль выполнен на отдельном МК, при подключении к основному копировщику он позволяет читать и копировать бесконтактные ключи формата <span class="T5">EM-Marin</span><span class="T4"> 125 </span>кГц<span class="T4">.</span> За основу была взята уже ставшая «классикой» схема на <span class="T4">PIC16F628A. </span>Поэтому если Вы уже собирали, например, <span class="T4">RFID-</span>копир от <span class="T5">Realid</span>, можно будет использовать его практически без изменений. Основные отличия предлагаемой схемы:</p><p class="P3">1) используется внутренний тактовый генератор МК на 4 МГц, поэтому внешний резонатор можно не устанавливать;</p><p class="P3">2) выход <span class="T5">RB0</span> модуля подсоединяется к <span class="T5">RA2</span><span class="T4"> </span>копировщика <span class="T4">(</span>луза);</p><p class="P3">3) выход <span class="T5">RB1</span><span class="T4"> </span>модуля подсоединяется к <span class="T5">RA1</span><span class="T4"> </span>копировщика (зеленый светодиод).</p><p class="P3">Таким образом, <span class="T4">RFID</span>-модуль представляет собой по сути эмулятор Даллас-ключей. Разумеется, он может так же использоваться и в этом качестве, отдельно от копировщика. Однако его работа совместно с другими «мастер»-устройствами не проверялась, и поэтому не гарантируется! <span class="T4">RFID-</span>модуль поддерживается только полнофункциональной версией копировщика, начиная с <span class="T1">6.2</span><span class="T5">1</span>, т.е. на минимальной конфигурации <span class="T1">5.2х</span> он работать не будет! Поэтому, если у Вас используется более старая версия, обновите прошивку.</p><p class="P3">Для чтения бесконтактного ключа поднесите его к контуру. При удачном считывании на дисплей копировщика будет выдано сообщение: «Ключ прочитан» и строкой ниже – прочитанный код. Спустя секунду в верхней строке появится тип прочитанного ключа, в данном случае «<span class="T5">RFID</span>» и адрес этого ключа в базе, если он будет в ней найден. Код ключа выводится в кодировке «Даллас» в следующем виде: <span class="T6">CRC</span><span class="T7"> 00</span><span class="T4"> </span><span class="T6">XX XX XX XX XX</span><span class="T4"> </span><span class="T7">00</span><span class="T4">.</span> Здесь цветом выделены байты, которые будут одинаковы для всех ключей данного типа, <span class="T1">ХХ</span> – это значащие байты кода. Таким образом, ключ будет виден как «Даллас» с <span class="T4">Family Code</span> = 00.</p><p class="P3">Для записи ключа нажмите кнопку «<span class="T4">Enter</span>». При этом на дисплей будет выдано приглашение: «Приложите заготовку». Поднесите заготовку к контуру. Запись начнется автоматически, как только заготовка будет распознана. При этом на дисплее появится сообщение: «Запись на Т5557» и прогресс-индикатор записи. Если запись пройдет успешно, на дисплей будет выведено сообщение: «Запись завершена», если будет обнаружен сбой, то будет дано сообщение: «Ошибка записи!». После отвода заготовки от контура копировщик вернется в режим чтения – загорится желтый светодиод и на дисплей будет выведен код ключа, находящегося в буфере.</p><p class="P3">В общем и целом, работа с бесконтактными ключами проходит по тому же принципу, что и с обычными контактными. Однако имеются некоторые особенности.</p><p class="P3">1) Совместимость форматов. Код бесконтактного ключа в принципе можно записать   на ТМ-заготовку, например на <span class="T4">RW-1990</span>. А вот обратное, к сожалению, не возможно. Это связано с тем, что Даллас-ключи имеют все 8 значащих байт, в то время как <span class="T4">RFID</span> – только 5. Поэтому, если нужно записать на бесконтактный ключ код, который изначально был «Далласом», войдите в главное меню, запустите «редактор» и поменяйте тип ключа с «<span class="T4">Dallas</span>» на «<span class="T4">RFID</span>».</p><p class="P3">2) Финализация заготовок. Заготовки Т5557 предоставляют возможность блокировать  перезапись путем установки пароля (можно рассматривать это как альтернативу временной финализации), либо установкой специального <span class="T4">LOCK</span>-бита при записи блоков, в этом случае финализация будет уже окончательной. <span class="T4">RFID-</span>модуль поддерживает финализацию обеих типов. Чтобы указать, что Вы желаете финализировать заготовку после записи, необходимо отредактировать байт конфигурации, который находится в <span class="T4">EEPROM</span> МК по адресу <span class="T1">00</span>.</p><p class="P3">Возможные значения конфигурации:</p><p class="P3"><span class="T1">00</span> (установлено по-умолчанию) – заготовки не будут финализироваться.</p><p class="P3"><span class="T1">80</span><span class="T4">h</span> (т.е. бит 7 = 1) – будет устанавливаться <span class="T4">LOCK-</span>бит на каждый записываемый блок и заготовка окончательно финализируется.</p><p class="P3"><span class="T1">40</span><span class="T4">h</span> (т.е. бит 6 = 1) – будет устанавливаться пароль на перезапись. Комбинацию пароля можно выбрать по своему желанию, он записывается так же в <span class="T4">EEPROM</span> по адресам <span class="T1">04-07</span>, изначально там записана комбинация «01020304».</p><p class="P3"><span class="T5">20</span><span class="T4">h </span>(бит 5 = 1) – запрет на распознавание запароленных заготовок. Данная возможность введена для работы с заготовками, не полностью совместимыми с <span class="T1">Т5557</span>, которые не позволяют проконтролировать запись отдельных блоков. При установленном бите , в случае отсутствия ответа заготовки после записи блока конфигурации, копировщик не будет пытаться записывать этот блок вторично со снятием пароля.</p><p class="P3">3) Распознавание ключей и заготовок. Ключи, а так же заготовки, записанные в стандарте <span class="T4">EM-Marin</span>, распознаются в «ознакомительном» режиме как «Ключ <span class="T4">EM-Marin</span>». Ключи и заготовки, записанные в других форматах (например, <span class="T4">HID</span>), а так же несконфигурированные заготовки, не распознаются – копир выводит сообщение «Заготовка не распознана»<span class="T4">. Это связано с тем, что обновленная версия не перезаписывает блок конфигурации, что исключает возможную порчу ключа. Тем не менее, в режиме записи заготовка конфигурируется и записывается, как обычно.</span></p><p class="P3">4) Один «хитрый» код. А именно: <span class="T1">00 00 00 00 00</span>. Для бесконтактных ключей такая комбинация вполне допустима. Однако, учитывая формат отображения кода копировщиком, она превращается в недопустимую для <span class="T4">Dallas</span>-ключей комбинацию из 8-ми «нулей», которую невозможно создать в редакторе. Поэтому, если потребуется создать такую комбинацию, необходимо вначале запустить через меню пункт «<span class="T4">CRC-</span>режим» и отключить контроль <span class="T4">CRC</span>. После этого «хитрый» код можно будет создать в редакторе. Разумеется, в дальнейшем бесконтактный ключ с таким кодом будет читаться и записываться копировщиком, не зависимо от установленного режима контроля <span class="T4">CRC</span>.</p><p class="P3">5) Хранение бесконтактных ключей в базе <span class="T4">EEPROM</span>. Происходит по такому же принципу, что и с ключами Метаком и <span class="T4">Cyfral</span>. Ключ сохраняется как «Даллас», но старший бит <span class="T4">Family Code</span> заменяется с 0 на 1, при этом значение <span class="T4">Family Code </span>становится = <span class="T1">80</span><span class="T4">h</span>. Байт <span class="T4">CRC</span> не пересчитывается. Такие ключи будут читаться из базы как «<span class="T4">RFID</span>». </p><p class="P3">Еще пару слов о конструкции модуля Печтаная плата имеет тот же размер и те же отверстия, что и плата копировщика – чтобы обе схемы можно было совместить в одну конструкцию. Так же на плате смонтирован общий выключатель. Соответственно, и питание тоже разведено для совместной работы этих двух устройств: выводы «<span class="T1">Vdd_IN</span>» и «<span class="T1">Vss_IN</span>» подсоединяются к источнику питания. Выводы «<span class="T1">Vdd»_OUT</span>» и «<span class="T1">Vss_OUT</span>» подсоединяются соответственно к "<span class="T1">+5</span><span class="T5">V</span>" и "<span class="T5">Gnd</span>"  копировщика. Вывод «<span class="T1">Vdd</span>» соединяется с коллектором транзистора  <span class="T1">VT1</span> на плате копировщика, если используется программное управление выключением питания и этот транзистор установлен. Этот контакт подписан на основной плате как «<span class="T5">Vdd RFID</span>».Если программное управление питанием не используется, то вывод «<span class="T1">Vdd</span>» нужно соединить с «<span class="T1">Vdd»_OUT</span>». Все соединения выполняются коротким изолированным проводом, который в собранной конструкции аккуратно укладывается «петельками» в промежутке между платами.</p><p class="P3"> На плате модуля установлен разъем для внутрисхемного программирования, чтобы каждый раз не разбирать копировщик для смены прошивки. В рабочем состоянии питание на МК подается через перемычку, надетую на выводы <span class="T1">JP</span> и <span class="T1">Vdd</span> разъема.</p><p class="P4">Перед окончательной сборкой устройства излучающий контур <span class="T4">RFID-</span>модуля необходимо настроить в резонанс на рабочую частоту 125 кГц. Резонанс настраивают по максимуму напряжения на катоде диода (в точке «<span class="T5">Test Point</span>»<span class="T4"> </span>на схеме<span class="T4">) </span>относительно «земли». Причём, важно добиться не какого-то конкретного значения, а именно максимума напряжения.</p><p class="Text_20_body_20_indent">Настройку можно выполнять двумя способами. Во-первых, подбором конденсатора <span class="T1">С1</span>. Например, вместо конденсатора можно временно установить подстроечник и настроить при помощи него контур в резонанс. Затем измерить получившуюся емкость подстроечника и подобрать конденсатор, наиболее близкий по номиналу. </p><p class="P3">Второй путь – подбором числа витков катушки, этот способ более простой, но и более грубый. Катушку наматываем заведомо б<span class="T1">о</span>льшим числом витков, например 130. Далее, от катушки отматываем по 1 витку, после каждого раза измеряя напряжение на диоде. Вначале напряжение должно расти, а затем, после отмотки очередного витка, оно начнет снижаться. Тогда возвращаем снятый виток на место, окончательно запаиваем провод и считаем контур настроенным.</p><p class="P3"> </p><h1 class="Heading_20_1"><a id="a__RECTO"><span/></a>RECTO</h1></body></html>